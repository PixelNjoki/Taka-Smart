<!doctype html>
<html>
<head>
  <meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Report Waste — TakaSmart</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<nav class="navbar">
  <div class="brand">TakaSmart</div>
  <div>
    <a class="btn-ghost" href="{{ url_for('index') }}">Home</a>
    <a class="btn-ghost" href="{{ url_for('view_reports') }}">View Reports</a>
  </div>
</nav>

<div style="max-width:920px;margin:36px auto;padding:0 18px;">
  <div class="card">
    <h2 style="color:var(--accent-2);margin-bottom:8px">Report Waste</h2>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div style="margin-bottom:12px">
        {% for c,m in messages %}
          <div class="flash" style="margin-bottom:8px">
            <div class="alert alert-{{ c }}">{{ m }}</div>
          </div>
        {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <form action="{{ url_for('report') }}" method="POST" enctype="multipart/form-data">
      <div style="display:flex;gap:12px;flex-wrap:wrap">
        <div style="flex:1;min-width:220px">
          <label>Your Name*</label>
          <input class="form-control" name="name" required>
        </div>
        <div style="flex:1;min-width:220px">
          <label>Email*</label>
          <input class="form-control" name="email" required>
        </div>
        <div style="flex:1;min-width:220px">
          <label>Phone</label>
          <input class="form-control" name="phone" placeholder="+2547...">
        </div>
      </div>

      <div style="margin-top:12px">
        <label>Location*</label>
        <input class="form-control" name="location" required placeholder="e.g. Nairobi CBD">
      </div>

      <div style="margin-top:12px">
        <label>Description*</label>
        <textarea class="form-control" name="description" rows="4" required></textarea>
      </div>

      <div style="margin-top:12px">
        <label>Upload Image</label>
        <input type="file" name="image" accept="image/*" class="form-control">
      </div>

      <!-- optional geolocation capture -->
      <input type="hidden" name="latitude" id="latitude">
      <input type="hidden" name="longitude" id="longitude">

      <div style="margin-top:18px;display:flex;gap:12px;align-items:center">
        <button class="btn-primary" type="submit">Submit Report</button>
        <button type="button" class="btn-ghost" onclick="navigator.geolocation && navigator.geolocation.getCurrentPosition(function(p){document.getElementById('latitude').value=p.coords.latitude;document.getElementById('longitude').value=p.coords.longitude; alert('Location captured')})">Capture Location</button>
      </div>
    </form>
  </div>
</div>

<script>
  // optional: request geolocation on page load (will ask the user)
  if (navigator.geolocation) {
    // do not auto-request to avoid blocking — user can press "Capture Location"
  }
</script>
</body>
</html>
